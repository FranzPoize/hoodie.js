<!DOCTYPE html>
<html class="no-js">
  <head>
    <base target="http://0.0.0.0:1337">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://0.0.0.0:1337/dist/css/hoodie.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Fira+Sans:300,500|Fira+Mono" type="text/css">
  </head>
  <body class="orange">
    <header>
      <section id="nav">
        <div id="logo"><img src="http://0.0.0.0:1337/dist/img/logo.svg" width="135" alt=""></div>
        <nav id="main-nav" aria-role="navigation"><a href="#">Intro</a><a href="#">Contribute</a><a href="#">Get help</a><a href="#">About</a><a href="#">Community</a><a href="#">Zoo</a><a href="#">Contact</a></nav>
        <ul id="meta-nav">
          <li><a href="#">Blog</a></li>
          <li><a href="#">Docs</a></li>
          <li><a href="#">try</a></li>
          <li><a href="#">FAQ</a></li>
        </ul>
      </section>
      <section class="hid">
        <ul id="sub-nav">
          <li><a href="/#">Team</a></li>
          <li><a href="/#">wear hoodie</a></li>
          <li><a href="/#">give money</a></li>
          <li><a href="/#">hire us</a></li>
          <li><a href="/#">contributors</a></li>
          <li><a href="/#">friends</a></li>
          <li><a href="/#">initiatives</a></li>
          <li><a href="/#">tools</a></li>
        </ul>
      </section>
    </header>
    <div id="content">
      <div class="box">
        <section class="cb teaser">
          <h1>Docs</h1>
          <aside>
            <ul>
              <li><a href="../index.html">Main</a></li>
              <li><a href="../hoodie/account.js.html">hoodie/account.js</a></li>
              <li><a href="../hoodie/connection.js.html">hoodie/connection.js</a></li>
              <li><a href="../hoodie/id.js.html">hoodie/id.js</a></li>
              <li><a href="../hoodie/open.js.html">hoodie/open.js</a></li>
              <li><a href="../hoodie/remote.js.html">hoodie/remote.js</a></li>
              <li><a href="../hoodie/request.js.html">hoodie/request.js</a></li>
              <li><a href="../hoodie/store.js.html">hoodie/store.js</a></li>
              <li class="active"><a href="../hoodie/task.js.html">hoodie/task.js</a></li>
              <li><a href="../hoodie.js.html">hoodie.js</a></li>
              <li><a href="../lib/error/error.js.html">lib/error/error.js</a></li>
              <li><a href="../lib/error/index.js.html">lib/error/index.js</a></li>
              <li><a href="../lib/error/object_id.js.html">lib/error/object_id.js</a></li>
              <li><a href="../lib/error/object_type.js.html">lib/error/object_type.js</a></li>
              <li><a href="../lib/events.js.html">lib/events.js</a></li>
              <li><a href="../lib/index.js.html">lib/index.js</a></li>
              <li><a href="../lib/store/api.js.html">lib/store/api.js</a></li>
              <li><a href="../lib/store/index.js.html">lib/store/index.js</a></li>
              <li><a href="../lib/store/remote.js.html">lib/store/remote.js</a></li>
              <li><a href="../lib/store/scoped.js.html">lib/store/scoped.js</a></li>
              <li><a href="../lib/task/index.js.html">lib/task/index.js</a></li>
              <li><a href="../lib/task/scoped.js.html">lib/task/scoped.js</a></li>
              <li><a href="../utils/config.js.html">utils/config.js</a></li>
              <li><a href="../utils/generate_id.js.html">utils/generate_id.js</a></li>
              <li><a href="../utils/hoodiefy_request_error_name.js.html">utils/hoodiefy_request_error_name.js</a></li>
              <li><a href="../utils/index.js.html">utils/index.js</a></li>
              <li><a href="../utils/local_storage_wrapper.js.html">utils/local_storage_wrapper.js</a></li>
              <li><a href="../utils/promise/defer.js.html">utils/promise/defer.js</a></li>
              <li><a href="../utils/promise/index.js.html">utils/promise/index.js</a></li>
              <li><a href="../utils/promise/is_promise.js.html">utils/promise/is_promise.js</a></li>
              <li><a href="../utils/promise/reject.js.html">utils/promise/reject.js</a></li>
              <li><a href="../utils/promise/reject_with.js.html">utils/promise/reject_with.js</a></li>
              <li><a href="../utils/promise/resolve.js.html">utils/promise/resolve.js</a></li>
              <li><a href="../utils/promise/resolve_with.js.html">utils/promise/resolve_with.js</a></li>
            </ul>
          </aside>
          <article>
            <section id="start">
              <h1>start</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.start()</span>
              </p>
            </section>
            <div class="description"><p>start a new task. If the user has no account yet, hoodie tries to sign up<br />for an anonymous account in the background. If that fails, the returned<br />promise will be rejected.</p> </div>
            <pre><code class="language-javascript">api.start = function(type, properties) {
    if (hoodie.account.hasAccount()) {
      return hoodie.store.add('$' + type, properties).then(handleNewTask);
    }

    return hoodie.account.anonymousSignUp().then(function() {
      return api.start(type, properties);
    });
  };</code></pre>
            <section id="abort">
              <h1>abort</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.abort()</span>
              </p>
            </section>
            <div class="description"><p>abort a running task</p> </div>
            <pre><code class="language-javascript">api.abort = function(type, id) {
    return hoodie.store.update('$' + type, id, {
      abortedAt: now()
    }).then(handleAbortedTaskObject);
  };</code></pre>
            <section id="restart">
              <h1>restart</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.restart()</span>
              </p>
            </section>
            <div class="description"><p>first, we try to abort a running task. If that succeeds, we start<br />a new one with the same properties as the original</p> </div>
            <pre><code class="language-javascript">api.restart = function(type, id, update) {
    var start = function(object) {
      extend(object, update);
      delete object.$error;
      delete object.$processedAt;
      delete object.abortedAt;
      return api.start(object.type, object);
    };
    return api.abort(type, id).then(start);
  };</code></pre>
            <section id="abortAll">
              <h1>abortAll</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.abortAll()</span>
              </p>
            </section>
            <div class="description"> </div>
            <pre><code class="language-javascript">api.abortAll = function(type) {
    return findAll(type).then(abortTaskObjects);
  };</code></pre>
            <section id="restartAll">
              <h1>restartAll</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.restartAll()</span>
              </p>
            </section>
            <div class="description"> </div>
            <pre><code class="language-javascript">api.restartAll = function(type, update) {

    if (typeof type === 'object') {
      update = type;
    }
    return findAll(type).then(function(taskObjects) {
      restartTaskObjects(taskObjects, update);
    });

  };</code></pre>
            <section id="subscribeToOutsideEvents">
              <h1>subscribeToOutsideEvents</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>subscribeToOutsideEvents()</span>
              </p>
            </section>
            <div class="description"><p>subscribe to store events<br />we subscribe to all store changes, pipe through the task ones,<br />making a few changes along the way.</p> </div>
            <pre><code class="language-javascript">function subscribeToOutsideEvents() {
    hoodie.on('store:change', handleStoreChange);
  }</code></pre>
            <section id="subscribeToOutsideEvents">
              <h1>subscribeToOutsideEvents</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">method</div><span>api.subscribeToOutsideEvents()</span>
              </p>
            </section>
            <div class="description"><p>allow to run this only once from outside (during Hoodie initialization)</p> </div>
            <pre><code class="language-javascript">api.subscribeToOutsideEvents = function() {
    subscribeToOutsideEvents();
    delete api.subscribeToOutsideEvents;
  };</code></pre>
            <section id="handleNewTask">
              <h1>handleNewTask</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>handleNewTask()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function handleNewTask(object) {
    var defer = getDefer();
    var taskStore = hoodie.store(object.type, object.id);

    taskStore.on('remove', function(object) {

      // remove &quot;$&quot; from type
      object.type = object.type.substr(1);

      // task finished by worker.
      if (object.$processedAt) {
        return defer.resolve(object);
      }

      // manually removed / aborted.
      defer.reject(new HoodieError({
        message: 'Task has been aborted',
        task: object
      }));
    });
    taskStore.on('update', function(object) {
      var error = object.$error;

      if (! object.$error) {
        return;
      }

      // remove &quot;$&quot; from type
      object.type = object.type.substr(1);

      delete object.$error;
      error.object = object;
      error.message = error.message || 'Something went wrong';

      defer.reject(new HoodieError(error));

      // remove errored task
      hoodie.store.remove('$' + object.type, object.id);
    });

    return defer.promise();
  }</code></pre>
            <section id="handleAbortedTaskObject">
              <h1>handleAbortedTaskObject</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>handleAbortedTaskObject()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function handleAbortedTaskObject(taskObject) {
    var defer;
    var type = taskObject.type; // no need to prefix with $, it's already prefixed.
    var id = taskObject.id;
    var removePromise = hoodie.store.remove(type, id);

    if (!taskObject._rev) {
      // task has not yet been synced.
      return removePromise;
    }

    defer = getDefer();
    hoodie.one('store:sync:' + type + ':' + id, defer.resolve);
    removePromise.fail(defer.reject);

    return defer.promise();
  }</code></pre>
            <section id="handleStoreChange">
              <h1>handleStoreChange</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>handleStoreChange()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function handleStoreChange(eventName, object, options) {
    if (object.type[0] !== '$') {
      return;
    }

    object.type = object.type.substr(1);
    triggerEvents(eventName, object, options);
  }</code></pre>
            <section id="findAll">
              <h1>findAll</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>findAll()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function findAll(type) {
    var startsWith = '$';
    var filter;
    if (type) {
      startsWith += type;
    }

    filter = function(object) {
      return object.type.indexOf(startsWith) === 0;
    };
    return hoodie.store.findAll(filter);
  }</code></pre>
            <section id="abortTaskObjects">
              <h1>abortTaskObjects</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>abortTaskObjects()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function abortTaskObjects(taskObjects) {
    return taskObjects.map(function(taskObject) {
      return api.abort(taskObject.type.substr(1), taskObject.id);
    });
  }</code></pre>
            <section id="restartTaskObjects">
              <h1>restartTaskObjects</h1>
              <h5 class="subheader"></h5>
              <p>
                <div class="label label-info radius ctx-type">function</div><span>restartTaskObjects()</span>
              </p>
            </section>
            <div class="description"><p>@private</p> </div>
            <pre><code class="language-javascript">function restartTaskObjects(taskObjects, update) {
    return taskObjects.map(function(taskObject) {
      return api.restart(taskObject.type.substr(1), taskObject.id, update);
    });
  }</code></pre>
          </article><br class="clear">
        </section>
      </div>
    </div>
    <footer>
      <div class="footer">
        <section class="cb sitemap"></section><br class="clear">
      </div>
    </footer>
    <script>
      /**
       * Prism: Lightweight, robust, elegant syntax highlighting
       * MIT license http://www.opensource.org/licenses/mit-license.php/
       * @author Lea Verou http://lea.verou.me
       */(function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e){n.call(e,r,e[r]);t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;if(a){o=(a.className.match(e)||[,""])[1];u=t.languages[o]}if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o;a=r.parentNode;/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data));l.element.innerHTML=l.highlightedCode;s&&s.call(l.element);t.hooks.run("after-highlight",l)};c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else{l.highlightedCode=t.highlight(l.code,l.grammar);l.element.innerHTML=l.highlightedCode;s&&s.call(r);t.hooks.run("after-highlight",l)}},highlight:function(e,r){return n.stringify(t.tokenize(e,r))},tokenize:function(e,n){var r=t.Token,i=[e],s=n.rest;if(s){for(var o in s)n[o]=s[o];delete n.rest}e:for(var o in n){if(!n.hasOwnProperty(o)||!n[o])continue;var u=n[o],a=u.inside,f=!!u.lookbehind||0;u=u.pattern||u;for(var l=0;l<i.length;l++){var c=i[l];if(i.length>e.length)break e;if(c instanceof r)continue;u.lastIndex=0;var h=u.exec(c);if(h){f&&(f=h[1].length);var p=h.index-1+f,h=h[0].slice(f),d=h.length,v=p+d,m=c.slice(0,p+1),g=c.slice(v+1),y=[l,1];m&&y.push(m);var b=new r(o,a?t.tokenize(h,a):h);y.push(b);g&&y.push(g);Array.prototype.splice.apply(i,y)}}}return i},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[];r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e;this.content=t};n.stringify=function(e){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]"){for(var r=0;r<e.length;r++)e[r]=n.stringify(e[r]);return e.join("")}var i={type:e.type,content:n.stringify(e.content),tag:"span",classes:["token",e.type],attributes:{}};i.type=="comment"&&(i.attributes.spellcheck="true");t.hooks.run("wrap",i);var s="";for(var o in i.attributes)s+=o+'="'+(i.attributes[o]||"")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'" '+s+">"+i.content+"</"+i.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r])));self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1];if(r){t.filename=r.src;document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)}})();;
      Prism.languages.markup={comment:/&lt;!--[\w\W]*?--(&gt;|&gt;)/g,prolog:/&lt;\?.+?\?&gt;/,doctype:/&lt;!DOCTYPE.+?&gt;/,cdata:/&lt;!\[CDATA\[[\w\W]+?]]&gt;/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?&gt;/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|&gt;|"/g}},punctuation:/\/?&gt;/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi};Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});;
      Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:/@[\w-]+?(\s+[^;{]+)?(?=\s*{|\s*;)/gi,url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,property:/(\b|\B)[a-z-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g};Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}});;
      Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g};;
      Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|catch|finally|null|break|continue)\b/g,number:/\b(-?(0x)?\d*\.?[\da-f]+|NaN|-?Infinity)\b/g});Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}});Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}});;
      
      
    </script>
  </body>
</html>